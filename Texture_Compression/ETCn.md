# ETCn家族压缩算法

将4x4的像素块分成16个区域，即每个区域表示一个像素。ETC1使用一个64bit编码描述压缩。
ETC1有两种模式：“individual”模式和“differential”模式。对于特定的4×4块，哪种模式处于活动状态由位33控制，我们称之为diff位。如果diff位 = 0，则选择“individual”模式，如果diff位 = 1，则选择“differential”模式。

![Alt](./res/ETC1.png#pic_center)

在这两种模式下，4×4块都被分为两个大小为2×4或4×2的子块。这是由位32控制的，我们称之为翻转位。
如果翻转位 = 0，则该块被并排划分为两个2×4子块（两个竖直的长条）。
如果翻转位 = 1，则该块被划分为两个相互叠置的4×2子块。

“individual”模式下，每组Base color中的一个颜色占四个bit，在解压成8bit通道时，解压方式是将低四位复制到高四位，这使得编码变成了固定的间隔，而无法覆盖到特定的灰度值。

$$
0010 ---> 00100010 \\
2 ---> 34
$$

可见，扩展之后，相当于十进制中乘以17.

“differential”模式每组Base Color由一个五位的基本色和一个三位的offset组成。
解压时将五位中的低三位复制到高三位，这就是第一个颜色。第二个颜色表示一个-4到3的三位偏差添加于第一个五位的基本色后之后，再做一样的操作。

$$
10110 ---> 11010110
$$

除了以上，两种模式接下来的操作没有差异。两个表码字(table codeword)用来描述两个子块，在其3bit的信息中用一个8行的硬编码表进行索引，索引包含四个数值，其相较于BaseColor的偏移最终通过具体到每个像素的两个bit分别索引。

![Alt](./res/ETC1_codeword.png#pic_center)

ETC1S格式是ETC1的子集，经过简化以方便图像压缩。
块使用差分编码（diff bit = 1）；颜色增量$R_d = G_d = B_d = 0$，因此两个子块共享基色。每个子块的表码字是相同的。
最后，翻转位被编码为0，因为无论如何子集都是相同的。

## ETC2

ETC1只支持RGB，这使得它的应用场景有些受限。ETC2 RGB是ETC1的超集，这意味着其同样可以用于解析ETC1格式的纹理。在此基础上，ETC2提出了三种模式，"T"模式和"H"模式用于尖锐的颜色块，"Planar"模式用于平滑的块。

无符号R11 EAC是一种单通道无符号格式。与RGBA ETC2的alpha部分类似但不完全相同；它提供更高的精度。可以制造出能够以最小的开销解码这两种格式的硬件。

无符号RG11 EAC是一种双通道无符号格式。每个通道均完全按照Unsigned R11 EAC进行解码。

