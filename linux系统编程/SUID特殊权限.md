# SUID特殊权限

其实除了rwx权限，还会用到s权限(并非保留用户ID)，例如：

```bash
ls -l /usr/bin/passwd
-rwsr-xr-x. 1 root root 22984 Jan 7 2007 /usr/bin/passwd
```

s权限，此种权限通常称为SetUID，简称SUID特殊权限。
SUID 特殊权限仅适用于可执行文件，所具有的功能是，只要用户对设有SUID的文件有执行权限，那么当用户执行此文件时，会以文件所有者的身份去执行此文件，一旦文件执行结束，身份的切换也随之消失。

Linux系统中，绝大多数命令的文件所有者默认都是root。

前提条件：

1. 只有可执行的二进制程序才能设定SUID。
2. 命令执行者要对该程序拥有x(执行)权限。

功能：

1. 命令执行者在执行改程序时获得该程序文件属主的身份（在执行程序的过程中灵魂附体为文件的属组）
2. SetUID权限只在该程序中有效，也就是说身份改变只在程序执行过程中有效。

例如: passwd命令拥有SetUID权限，所以普通用户可以修改自己的密码

普通用户可以改自己的密码的，真正的密码其实写入了/etc/shadow文件中。但是通过查看shadow文件的权限可知,shadow文件的权限是000,普通用户别说写了，连看都看不到这个文件，但是普通用户可以更改自己的密码，实际上是写入了/etc/shadow这个文件，普通用户明明对他没有权限，怎么可能写入这个文件的?
因为这个passwd这条命令作用的，当普通用户执行passwd这条命令的时候，因为passwd有SUID权限， 任何普通用户在执行这条命令的时候，都暂时性地获得这个文件的所有者权限，普通用户在执行passwd命令的时候，系统没有把他当作普通用户来对待，而是当作超级用户来对待，超级用户对shadow文件拥有任何权限，虽然shadow文件的权限是000，到那时这个权限对超级用户是没有意义的超级用户对这个文件依然有rwx权限。

* 设置SUID是一件危险的事情，这意味着你将赋予一些可执行文件被执行时的极高权限。
