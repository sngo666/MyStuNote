# 图像可逆数据隐藏技术研究综述

## 信息隐藏技术分类及特性

信息隐藏主要研究内容是如何将秘密信息进行特殊编码，以形成未授权用户不可识别的密码，从而保证信息安全性的一门技术。
信息隐藏技术主要包括数字水印、信息隐写以及可逆隐藏三个方向。他们之间的联系和区别如图中（原文图1），数字水印更注重研究嵌入对象的鲁棒性，在有损传输的情况下能够保护数字内容的版权安全；信息隐写更加侧重于数据嵌入行为的不可感知性，多用于隐蔽通信；可逆隐藏需要将嵌入的信息完整提取，并且能够保证恢复原始载体。

如图（图2）为信息隐藏技术应用概括的树状图，下面我们简述信息隐藏技术特性。
与传统加密技术所不同的是，信息隐藏技术在不刻意限制和加密资料存取的前提下，保证隐藏的数据不被侵犯和发现，因此要求具备以下特性：

* 透明性（不可感知性）：在原始载体嵌入秘密数据后，这些数据不能在人类感官上被感知到，应当保证嵌入的结果不会给载体带来感知上的失真。
* 鲁棒性（健壮性）：在遭受攻击后，在不产生载体质量明显下降的前提下，提取数据不会因为攻击而丢失。
* 安全性：隐藏数据的算法要能够抵抗恶意攻击，保证受到隐藏的数据不会受到破坏，对于密钥的生产分发和管理环节也同样是出于对安全性的考量。
* 不可检测性：嵌入数据后，不能够被第三方检测到存在嵌入行为。
* 自恢复性：载体在经过变换后可能会受到较大破坏，根据变换后留下的数据片段，能够推出原始的嵌入数据（目前大部分信息隐藏算法并不具备该特性）。

## 可逆数字隐藏技术

### 基本框架

可逆数据隐藏（RDH）技术主要包含嵌入过程和提取过程两个阶段，首先，发送端根据所选用的嵌入算法将秘密数据嵌入到原始载体图像中，然后将包含嵌入数据的载体发送给接受者，接收端再利用相对应的提取算法恢复出嵌入数据和原始图像，这项技术的研究核心是高性能的数据嵌入算法。

### 性能评估

为了客观评价数据嵌入算法的性能，我们引入峰值信噪比（PSNR）以及嵌入率（BPP）两个概念。

* 峰值信噪比

PSNR用于评价嵌入数据后的图像质量。其值越高，说明嵌入算法的性能越好，图像质量也就越好。在图中的公式中，MSE为均方误差，峰值比与原始载体的像素值成正相关，Imax为像素值的最高值，某些情况下也可以直接设置为255。

* 嵌入率

嵌入率为嵌入的比特总数和图像像素总数的比值，当BPP较大时，说明嵌入容量较大，嵌入算法的性能也会越好。

## 典型的RDH算法

最早的可逆数据隐藏方案由Barton在美国提出，迄今为止，已经在加密域，JPEG压缩和空间域提出了许多方案。

在可逆数据隐藏领域，空域图像因其嵌入容量高，视觉质量好且计算复杂度低的优点，被广泛应用。今天主要介绍基于差值扩展（DE），直方图平移（HS），预测误差扩展（PEE），像素值排序（PVO）和插值技术（IT）等几种技术的空域RDH算法。

早期对于RDH的研究，主要使用的是基于无损压缩的方法，主体思想是对图像进行无损压缩以产生冗余空间，再将秘密数据嵌入冗余空间中。在这种模式中，由于位移平面具有非常弱的相关性，一定程度上会限制嵌入容量的大小。对载体图像进行压缩也会产生噪音，引入更大的失真，影响最终图像的质量。

## 基于DE的RDH算法

首次于2003年提出的基于DE的RDH方案将原始载体图像划分为两个相邻像素对，以更好利用像素间的相关性，然后通过可逆整数变换扩展两个像素之间的差值以达成能够将一位秘密数据嵌入到像素对中，这种方法能够使理论上的最大BPP达到0.5。在容量和图像质量远胜于基于LC的RDH方案。目前对基于DE的RDH方案依然在不断深入和改进，当使用四个像素组成一个矢量用以嵌入一个3位秘密数据时，能够支持的理论最大BPP已经达到0.75。在实验（Alattar A M. Reversible watermark using the difference expansion of a generalized integer transform[ J]. IEEE Transactions on Image Processing, 2004, 13(8) : 1147-1156.）中发现，当选择n个像素视为一个向量时，选择的n越大，BPP就会越大，同时造成的图像失真现象也会越严重。

下面简要概括差值扩展的数据嵌入和提取步骤：

1. 首先选择给定像素对(x0, x1)，假设待嵌入的秘密数据为m，m取0或1。
2. 计算x0和x1的平均值L以及差值h，公式为:

> L = (int)((x0 + x1) / 2)
> h = x1- x0

3. 将差值h转换为二进制，并左移一位，再将一位秘密数据嵌入其中，生成新的差值h'，该过程可表示为

> h' = 2h + m

4. 根据差值h'和平均值L计算嵌入秘密数据后的像素值，公式为

> x0' = L - (int)(h' / 2)
> x1' = L + (int)((h' + 1) / 2)

5. 以上为嵌入过程，接下来是对于秘密数据的提取过程。首先计算含有秘密数据像素对(x0', x1')的平均值和差值。

> L' = (int)((x0' + x1') / 2)
> h' = x1'- x0'

6. 将h'转为二进制数，其最低有效位(LSB)即为嵌入的秘密数据，该过程可表示为

> m = LSB(h')

7. 得到原始差值h = (int)(h' / 2) 后，恢复原始像素对(x0, x1)可表示为

> x0 = L' - (int)(h / 2)
> x1 = L' - (int)((h + 1) / 2)

由于DE方案的特性，该过程具有计算简单，实现效率高的特点，但是相对而言，对于含有辅助数据的秘密数据来说，容量的限制可能会是主要的缺陷，当嵌入数据不大且载体图像较为平滑时，选用DE方案能取得较好的性能。
