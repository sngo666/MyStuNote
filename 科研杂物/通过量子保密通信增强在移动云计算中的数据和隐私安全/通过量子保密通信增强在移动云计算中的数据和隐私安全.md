# 通过量子保密通信增强在移动云计算中的数据和隐私安全

## 量子保密通信概述

量子密码学不同于经典密码学，并非建立在数学算法的计算强度上，而是通过物理手段生成真正的随机数和在公共信道上无法被窃听的密钥分发。其能够满足OTP算法，即一次一密的三个条件，密钥必须完全随机，密钥不能够重复使用和密钥需和明文等长。其具有代表性的产物有量子随机数发生器（QRNG）和量子密钥分发（QKD）技术，通过本次的论文引出并着重介绍QKD技术，下面首先介绍量子密钥分发技术的原理。

### 量子密钥分发技术（QKD）

根据图中所给出的简单工作机制示意图可以看出，一个最基本的点对点QKD系统模型分成发射机和接收机两部分，其之间的信道由传统多路复用信道和量子信道组成，量子信道用于用于传输量子态承载的量子比特信号，可以利用光纤等介质进行传输，下面会以光信号为例简要介绍该量子通道的传输机制。经典信道用于发送方和接收方进行基矢比对等数据后处理数据的信息步骤，用于辅助生成对称密钥。
由于QKD传递本身的特殊机制，无需担心窃听者的存在，发送者和传送者可以在这一过程中发现窃听行为。

下面以Alice与Bob之间进行量子保密通信时为例，首先需要进行的是QKD对称密钥的分发，分发的第一个步骤是通过量子信道进行量子态的编码，发送传递和测量解码。为了方便介绍接下来的密钥分发过程，引出简短的背景知识介绍，这方面我也没有过多深入。
量子是物理界最小的不可再分单位，光的最小单位即光子就是一种量子。在量子通信中一般使用光子的偏振态或相位信息传递信息，当我们将一个光子调制到指定偏振角度，接受端通过一个偏振分波器将光子分束到探测器上。

Alice和Bob均具备建立量子信道所需的专业光学设备，在发送伊始，发送方Alice选择2组偏振正交基的任意一种来调制单光子发送密钥，如表所示，这里选择0和90度作为第一组偏振正交基，选择45度和135度作为第二组。
首先Alice生成一串二进制随机密钥，并随机生成与随机密钥位数相同的偏振基，每一位随机密钥对应的偏振基可以是第一组，也可以是第二组，并在发射时以对应的随机偏振基调制光子信号，这是一种将数字转为物理编码的过程。与此同时，接收方Bob也会选择一组与随机密钥位数相同的偏振基。
根据量子的不可分割性，当接收方Bob选择的随机偏振基与发送方选择的偏振基时，能够准确接收并翻译出发送的位，但是当不一样时会被随机分配到某一个接收器，因此接收方接收到两个角度的概率是相等的。
在Bob根据单光子偏振态测量转换出密钥后，进入校验阶段，这时发送方Alice会将自己生成的随机偏振基组通过公开信道发送给Bob，Bob也会做相应的动作，此时双方通过偏振基组的匹配获得有效部分的二进制串，双方各选择有效串中的部分进行公开，若公开的部分不匹配，说明本次通信有窃听攻击，则本次密钥生成的过程作废。若匹配，则选择未公开的部分作为密钥。

为什么当发生窃听攻击时发送方与接收方中的匹配数据部分会不同？得益于其物理性质，QKD的安全性由海森堡测不准原理决定，一旦通过测量可以获得某个量子系统部分状态信息，那么该量子系统就必然会发生扰动，除非事先已知该量子系统的可能状态是彼此正交的，使得QKD过程中仅当接收方采用与发送方相同的偏振基进行制备测量时才能有效获得正确信息。
其次是根据量子不可克隆定理，该定理指出无法以一个量子比特为基础精确复制出它的完美副本，对量子态的复制必然会破坏其原有的量子比特信息、
最后是量子纠缠特性，当多个粒子彼此相互作用后，由各个粒子所拥有的特性已综合成为整体的性质，无法单独描述各个粒子的性质，只能描述整体系统的性质，保证信息不可能被泄漏给第三方。
因此其安全性主要在于二次公布。

### 回归到QKD网络

从最基础的QKD机制出发可以发现，QKD和经典的对称、非对称密码都各有其优势和劣势，对于QKD通信网络的建设仍需要与经典密码学相结合。类似于对称密钥机制，QKD网络仍然需要为每个用户提供特定的根密钥，并将密钥预置到鉴权中心和用户设备节点中以进行身份认证和鉴权，只不过其仅适用于用户能够通过光纤或卫星接入QKD网络的场景，QKD的缺陷在于铺设成本高，管理复杂，因此应用场景相对受限。

## Pair-Hand认证

在切换身份验证过程中使用不同的协议，这些协议需要两次以上的握手，Pair-Hand协议有四个过程，可以灵活使用于不同的移动通信和网络场景，分别是系统初始化启动，切换认证，批量认证和Dos攻击防御。

在第一部分中，选择用户的移动ID Ui进行计算结果为Si，并选择两个哈希函数H1，H2，最后选择用于生成私钥的数k，进行计算，uidi为是位于数据中心的身份验证服务器(AS)选择的伪造ID，IDapy是APy的标识，ts是时间戳。使用此签名，Ui与Apy建立一对一的连接通过访问请求消息，并在这之后计算共享对称密钥。

之后，Apy验证时间戳并检查签名Si，如果是有效的则进行下列计算。
Ui生成验证码以保证连接的身份，为比较APy发送的授权码，验证码Ver计算如下。如果结果相同，说明可以建立安全连接。

最后，在建立安全连接后，将签名后的消息传输到位于移动数据中心的AS。

## 移动云计算中的量子密码安全模型QCMC

基于量子密码的安全访问有三个阶段：量子密钥的分发阶段、基于可信的NFC中继节点的量子密钥中继相位以及移动用户在云端进行认证和加密传输的相位。如图所提出的模型，展示了云服务器、受信任的NFC设备节点（TNRN）和用户之间的关系，在云服务器和TNRN之间采用多路复用技术和基于经典网络的量子密钥分发系统。在系统工作中，量子密钥通过QKD网络分发给受信任区域的TNRN节点。同时在用户与TNRN节点沟通时，利用近场通信技术将量子密钥加密注入用户的手机中的安全存储区。最后是用户与服务器之间的沟通，使用Pair Hand进行基于移动网络的认证后，可以使用量子密钥访问云端数据。

在云服务器和TNRN节点之间的经典网络采用了密集波分复用(DWDM)技术,系统中采用增加了BIDI组装模块SFP在交换机上，将一对光纤网络转换为一张光纤网络。因而可以使用光开关连接另一跟光纤区分量子密钥，以升级为量子密钥分发网络。BIDI模块必须成对使用用以同时完成一个波长光信号的发射和另一个波长光信号的接收，从而实现和另一个相同的BIDI模块之间的双向通信。
云服务器和TNRN节点的量子密钥分发协议采用基于诱饵态的BB84协议，根据BB84协议，采用光的偏振特性，就如上面所举的例子。在该系统中，根据规定密钥长度进行响应的密钥分发，具体过程不多赘述，经过后处理阶段后，完成QKD。

### 基于可信NFC中继节点的生成量子密钥传输

在云服务器完成对于TNRN节点的量子密钥分发后，需要通过NFc技术将密钥传输给用户的手机中。NFc技术控制了10CM以内的最大通信距离。使用基于量子密钥和距离约束的安全认证协议HKQ以防止窃听攻击和中继攻击。

在初始化阶段，采用对称密钥的形式共享初始密钥qk，qx和哈希函数H，并设置允许往返的最大时间tmax。
第二个阶段为缓慢挑战响应阶段，TNRN和用户终端需要为下一阶段的快速响应做一些工作，比如TNRN向用户发送一个随机数N1、一段随机消息m并计算其哈希值，以便于在快速响应阶段生成响应挑战规则，手机回复另一个随机数N2，加密结果s = qk ^ m。
第三阶段是快速挑战响应阶段，此阶段包含n轮挑战响应，每次发送1位。TNRN选择一个挑战c，发送到用户终端，用户终端做出回应r，收到回应后TNRN记录时间间隔ti，ti指的是从发送挑战到接收到回应r为止的时间。
最后一阶段是验证阶段，在这一阶段，TNRN检查每一次挑战的往返时间，并使用tmax命令进行安全确认，最后检查qk ^ s的结果用以验证。

经过上述四个阶段量子密钥qk和AES加密算法加密传输到用户移动终端的安全存储区，且由于NFC技术的使用，保证有效的通信距离控制在极近的距离内，进一步使用更加安全的存储设备如安全存储芯片等，从而保证密钥的存储安全。

### 用户数据隐私保护和策略

移动用户数据的存储采用量子加密技术，当移动用户和云服务器进行数据存储时，移动用户的个人信息、联系人等信息是云服务器无法理解的，通过移动用户ID的哈希值访问用户所有的密钥分布和访问控制，从而严格制定用户数据访问、下载策略和各种严格的用户数据隐私保护策略。

### 手机用户和云Pair-Hand认证

在本系统中，访问云采用PairHand认证方式，通过生成一种基于时间的量子密钥访问控制令牌，此令牌只有云服务器和手机知道。


至此整个系统的三个节点，各节点所采用的的通讯方式以及工作流程以及介绍完毕，文中给出了一次实验，通过分别在不同长度的通讯距离下配置三个TNRN节点，系统工作后每小时进行一次量子密钥的生成速率统计。
单次通信流程中消耗320位的密钥，由于无论用户使用哪个TNRN节点接收量子密钥，云上的量子密钥管理服务都会根据用户的病情统一分配量子秘钥。因此，使用的QKD设备越多，云上可用的量子秘钥就越多。从图中可以看出，该模型可以很好的支持移动用户对量子秘钥的使用需求，保证移动用户可以使用量子秘钥和云应用加密访问数据。

