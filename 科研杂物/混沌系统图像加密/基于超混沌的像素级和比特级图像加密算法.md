# 基于超混沌的像素级和比特级图像加密算法

这是一篇目前引用次数342的文章。
由于图像数据本身具有大数据量，高冗余和相邻数据有强相关性的特点，使用AES等传统加密算法并不适合用于图像加密。
本文所提出的混沌系统具有遍历性，非周期性，对初始条件和控制参数具有高灵敏度和类随机行为等优良的内在特性。基于混沌映射的典型加密过程可以分为两个部分：置换和融合。在图像加密这一研究领域，之前的主流方式是在像素级排列的图像加密，从算法角度来看只是从数学角度研究如何改变像素的位置，所以选择明文和选择密文攻击可以轻易破解这些算法。如基于混沌切比雪夫发生器的图像加密算法，使用非线性切比雪夫函数生成密钥，相较于先前的其他系统的设计优势在于，整体降低了计算复杂度并维护安全性，主要流程简单来说就是，先生成两个伪随机序列，再将随机序列用于二维混沌切比雪夫函数，并同时添加参数用以扩大密钥空间。
![Alt](./res/pic_01_11.png#pic_center)

为了抵抗这两种攻击，提出了基于一次性密钥的图像加密和基于动态随机增长技术的新的混沌块图像加密算法，并非能够完全低于这种攻击。

除了使用混沌系统，还有一篇基于简单表查找和交换技术的有效扩散方案作为图像混沌映射的轻量级替代，并且基于混沌理论的思想和拉丁方模式，使其在程序层面性能高于浮点运算。
![Alt](./res/pic_01_09.png#pic_center)

除此之外，人们发现DNA计算具有大规模并行、巨大存储和低功耗的特点，提出了很多基于DNA规则的图像加密相同的特点，然而却同样具有像素级图像加密算法的弱点。

相较于低位混沌系统和高位混沌系统，超混沌系统由其所不具备的优势，即更大的密钥空间，更好的灵敏度、更加复杂的动态特性和随机性。直到这篇文章提出的算法之前，还未有同时使用像素级和比特级排列的算法，此外并采用超混沌系统来抵御破译低维混沌映射的一般方法。

对于基于混沌图像密码系统，时间消耗主要来源于混沌映射迭代和量化操作，在满足安全要求的前提下，对于这几方面的优化可以有效提升性能。

## 混沌系统

这里的混沌并非指的是无序，而是当一个简单确定的系统不仅可以产生简单确定的行为，还可以产生貌似随机的不可确定行为。对于混沌的定义是指确定的宏观非线性系统在一定条件下所呈现的不确定的或不可预测的随机现象；是确定性与不确定性，规则性与非规则性；有序性与无序性融为一体的现象。这也和密码学对于加密算法的要求有一定吻合之处。我们对于混沌定义以下几个特征:

* 首先是对于初始条件的灵敏依赖性，通俗来说就是蝴蝶效应，“失之毫厘差之千里”，局部或足够微小的扰动都会对于系统最后的结果产生较大的改变。
* 长期不可预测性，混沌的非线性动力学特性决定了混沌是不可预测的，一方面混沌对于数值的高敏感决定了对于算法的预测存在相当的难度。

如图所示，这里是一个5-D多翼超混沌系统,我们称其为系统。其中包含三个非线性元素。
![Alt](./res/pic_01_01.png#pic_center)

下面首先引出一个概念：又称李雅普诺夫特征指数，是用于识别混沌运动的一个特征
。常常被用来判定一个系统的混沌性，通过图像可以直观地看出某个系统或者映射是否是混沌系统或映射。
判定依据是当其大于0时，说明系统会进入混沌态，对应的映射也具备被称为混沌映射的资格。小于零时说明会趋于稳定且此时对系统的初始状态不敏感，等于零时说明系统稳定。
![Alt](./res/pic_01_02.png#pic_center)

首先文中给定实验参数从图中实验可以看出，当d<0时，系统是稳定的，此时没有出现正李雅普诺夫指数，当d在8.8和20之间时，系统被证明是混沌的，而d大于20后，系统是超混沌的。

## 图像加密算法详情

算法共分为四个部分：首先根据处理图像的特征生成对应的混沌序列，采用像素级排列以混淆图像，接着利用位级置换来增强秘密系统的安全性，最后通过扩散得到密文。
![Alt](./res/pic_01_03.png#pic_center)

* 像素级排列过程

像素级排列的本质是为了破坏像素的相关性，在文中的设计为：
首先将数字图像矩阵转为一维向量，比如一个`m*n`形式的像素，对其作扁平化处理，得到一个一维向量，长度为`m*n`。
计算所有像素的总和，根据以下公式计算出混沌系统的初始密钥x1~x5。这里的s是图片的面积。

![Alt](./res/pic_01_04.png#pic_center)

接着我们使用前文所提出的混沌系统(1)，进行N0+m*n次迭代，之后丢弃前N0个值以避免有害的影响，产生的混沌序列有`m*n`个元素，记为L。
在这部分的最后一步，我们将使用混沌序列对图片向量进行处理，将混沌序列按升序排列，得到一个序列L'，对图像像素序列P进行像素位置的置换，得到处理后的最终序列Q。

* 比特级置换过程

在这个过程中，对序列使用比特级排列来改变像素的位，位置换过程将重新创建四个新字节，通过组合四个字节的方式改变每个字节的位。从数学角度来看，这部分的操作本质上相当于一个向量乘以一个常数矩阵。
将上一部分最后得到的混洗序列Q分解成4*4的矩阵，接着将一个常数矩阵和分割出的子矩阵相乘，得到一个新的矩阵，常数矩阵和逆矩阵如下图所示。

![Alt](./res/pic_01_05.png#pic_center)

重复计算直到所有子矩阵都完成了一轮比特级置换操作，然后组合子矩阵获得矩阵D，其尺寸为m*n

* 扩散阶段

扩散过程可以大大增强对统计攻击和差分攻击的抵抗力，保证密文图像的直方图相当均匀，并且要与普通图像的直方图显著不同。
为了实现良好的扩散过程，应使用与普通图像密切相关的关键流。当对不同的平面图像进行加密时，我们可以在加密算法中得到完全不同的混沌序列。

根据下述公式获得密钥流，其中的L是混沌序列。
![Alt](./res/pic_01_06.png#pic_center)
并通过下公式加密图像矩阵D的像素值:
![Alt](./res/pic_01_07.png#pic_center)
其中C0是一个定义的常数，也可以用作加密密钥。

然后重复步骤2，直到i=m*n,得出最终的密码图像C。

* 解密阶段

解密过程与加密过程相反，首先得到混沌系统产生的混沌序列之后，并通过以下公式执行扩散的逆运算以获得加扰图像D',然后执行类似的矩阵切割操作，利用上面给出的逆矩阵进行相应的逆运算，对于加密过程中的像素级排列我们已经知道排列过程，在这里执行反转操作便可以得到原来的图像。
![Alt](./res/pic_01_08.png#pic_center)

## 安全性分析

在该算法中，密钥包括混沌系统的初始值，迭代次数N0和常数C0，取常数C0 = 28，初始值的精度为`10^16`，总密钥空间大约为`2^273`。而对于嵌入式密码系统，密钥空间的大小应该不低于2^100，本算法是完全符合要求的。

其次是直方图分析，对于原始图像的加密算法要求产生的加密图像与原图片相似度差且像素分布均匀，对于每个密钥的数量分析，我们计算直方图的方差以评估加密图像分布的均匀性，方差值越低，表示加密图像的均匀性越高。
![Alt](./res/pic_01_10.png#pic_center)
对于明文图像的直方图值为33860.0547因而表明所提出的算法可以抵御任何形式的攻击。
