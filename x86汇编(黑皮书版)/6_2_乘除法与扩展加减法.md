# 乘除法与扩展加减法

32位模式下，整数乘法可以实现32，16，8位的操作，MUL指令和IMUL指令分别执行有符号数和无符号数乘法。DIV和IDIV同理。

* MUL指令

32位模式下，MUL（无符号数乘法）指令有三种类型：

1. 执行8位操作数与AL寄存器的乘法。
2. 执行16位操作数与AX寄存器的乘法。
3. 执行32位操作数与EAX寄存器的乘法。
上述三种形式可以使用寄存器和内存，但是不能使用立即数（MUL是一元运算符）。即使用哪种情况取决了操作数的位数。
AL与寄存器/内存产生的乘积存放在AX中，AX参与产生的乘积存放在DX:AX中，EAX参与产生的乘积存放在EDX:EAX中。如果乘积的高半部分不为0，则会将进位标志位和溢出标志位置1。我们通常用这种方式检测乘积的数据宽度。

对于64位模式中，有RAX参与的乘法产生的128位乘积存放在RDX:RAX中。

* IMUL指令

与MUL不同，IMUL会保留乘数的符号，实现的方法是将乘积低半部分的最高位符号位扩展到高半部分，x86指令集支持三种格式的IMUL指令，即一至三个操作数。
单操作数模式中，乘积存放方式与MUL指令相同。
双操作数模式中（32位模式）将乘积存放在第一个操作数中，第二个寄存器可以是寄存器（第一个操作数的位数)、内存（第一个操作数的位数)或是操作数(8位或第一个操作数的位数)。在这种情况下，结果会按照目标操作数的大小来截取乘积，如果被丢弃的是有效位，则将溢出标志位和进位标志位置1。
三操作数中，将第二、第三个操作数相乘，保存在第一个操作数中，位数和操作数类型可以为以下组合：
|  reg  | mem/reg |  imm  |
| :---: | :-----: | :---: |
|  16   |   16    |   8   |
|  16   |   16    |  16   |
|  32   |   32    |   8   |
|  32   |   32    |  32   |


