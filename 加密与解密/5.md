# 演示版保护技术

## 序列号保护方式

序列号(注册码)保护技术是一种常见的软件版权保护技术，具体实现流程为用户向提供服务方发送一段个人信息码(视具体情况而定)，服务商使用预先编写的KeyGen(注册机)生成一个序列号并发送，用户同时输入个人信息码和序列号解锁软件使用权。

* 保护机制

软件验证序列号，本质在于验证用户名和序列号之间的数学映射关系，根据映射关系的不同，程序检查序列号有4种形式。

a. 将用户名信息作为自变量，通过函数F变换之后得到注册码

通过验证注册码合理性的程序是在客户端上执行的，这会带来一定的风险，利用调试器从内存中获取明文，测试计算过程或是修改判定符号可以绕过程序，这种方法是极其脆弱的。

b. 通过注册码验证用户名的合理性

与第一种方法不同的是，这里的变换函数F是可逆的，软件在检查注册码时，利用F的逆变换F^(-1)对用户输入的注册码进行验证。相对来说注册码的生成函数并没有直接出现在程序体或者内存中，看起来安全一些，但是实际上也有许多破解方案，诸如针对给定用户名的穷举攻击或是给定序列号反向生成用户名等方案。

c. 通过对等函数检查注册码

满足以下条件:`F1(用户名) = F2(注册码)`,可以被认为是正确的注册码，以上三种方法采用的自变量都只有一个，是用户名或注册码。

d. 同时将用户名和注册码作为自变量

这种检查注册码的方法将采用如下规则：当对用户名和序列号进行变换，如果得出的结果等于某个特定的值，则被认为是合法的用户名/序列号对。
`特定值 = F(用户名, 序列号)`
虽然可能会丢失用户名和序列号之间的对应关系，但是也有相对应的解决方法:建立一个用户名和序列号之间的数据库。进一步地说，可以根据这一思路把用户名和序列号分成多个部分构造多元的算法。

* 针对序列号保护机制的攻击

一种方法是通过跟踪输入注册码之后的判断找到注册码。通常过程是用户在一个编辑框中输入注册码，软件调用一些标准API将用户输入的注册码复制到自己的缓冲区。常用的API包括:GetWindowTextA(W),GetDlgItemTextA(W),GetDlgItemInt等。程序完成对于注册码的判断流程后一般会显示一个对话框，如MessageBoxA(W),MessageBoxExA(W),ShowWindow,MessageBoxIndirectA(W),CreateDialogParamA(W)等
